"use strict";(function(){var n=function(){var u=window.location.origin+window.location.pathname,n=window.location.search,i=n.match(/page=([^&]*)/),t,r;i?(t=i[1],t=t.length>0?parseInt(t,10)+1:2,n=n.replace(/page=[^&]*/,"page="+t)):n=n.length===0?"?page=2":n+"&page=2";r=u+n;window.location.href=r},t=function(){var u=this.self,t="id="+parseInt($("#input_id_filter")[0].context.get_value(),10),r=window.location.origin+window.location.pathname,n=window.location.search,i;n=n.indexOf("id")>0?n.replace(/id=[^&]*/,t):n.length===0?"?"+t:n+"&"+t;i=r+n;window.location.href=i},i=function(n,t){var u=t.flyout.context,i=u.item,r=$(i).find("div[data-control='button']")[0];r.context.events.clear("click");r.context.events.add("click",function(n){var r=$(i).find(".checkbox_ispublic")[0].context.is_checked(),t=$(n.parentElement).find("textarea").val();t!==undefined&&t.length!==0&&$.post("/member/AddDetailMessage",{id:window.modelId,token:window.actionToken,message:t,ispublic:r},function(n){n.result?window.location.reload():alert("false")})})},r=function(n,t){var r=t.flyout.context,u=r.item,i=$(u).find("div[data-control='button']")[0];i.context.events.clear("click");i.context.events.add("click",function(){$.post("/member/CloseDetail",{id:window.modelId,token:window.actionToken},function(n){n.result?window.location.reload():alert("false")})})},u=function(n,t){var r=t.flyout.context,u=r.item,i=$(u).find("div[data-control='button']")[0];i.context.events.clear("click");i.context.events.add("click",function(){$.post("/member/CompleteDetail",{id:window.modelId,token:window.actionToken},function(n){n.result?window.location.reload():alert("false")})})},f=function(n){var t=n.context;$.post("/member/AcceptDetail",{id:window.modelId,token:window.actionToken},function(n){n.result?window.location.reload():alert("false")})},e=function(n){var t=n.context;$.post("/member/CancelAcceptDetail",{id:window.modelId,token:window.actionToken},function(n){n.result?window.location.reload():alert("false")})},o=function(){var r=window.location.origin+window.location.pathname,u=$("#select_filter")[0].context.selected_index(),n=window.location.search,t="filter="+["uncompleted","me","closed","completed","all"][u],i;n=n.indexOf("filter")>0?n.replace(/filter=[^&]*/,t):n.length===0?"?"+t:n+"&"+t;i=r+n;window.location.href=i},s=function(){var r=this,u=r.previousElementSibling,f=u.children[0].innerText,t=f.match(/ID:\s*(\d+)/)[1],e=window.location.origin+window.location.pathname,n=window.location.search,i;n=n.indexOf("id")>0?n.replace(/id=[^&]*/,"id="+t):n.length===0?"?id="+t:n+"&id="+t;i=e+n;window.location.href=i},h=undefined,c=function(){$.post("/member/LoginHeartbeat",{},function(n){n.result||console.error("心跳保持失败")})},l=function(){$("#select_filter")[0].context.events.add("changed",o);$(".itemslistview .itemcover").click(s);$(".submit_message").each(function(){this.context.events.add("flyout_showing",i)});$(".btn_markcancel").each(function(){this.context.events.add("flyout_showing",r)});$(".accept_detail").each(function(){this.context.events.add("click",f)});$(".cancelaccept_detail").each(function(){this.context.events.add("click",e)});$(".complete_detail").each(function(){this.context.events.add("flyout_showing",u)});$("#btn_id_filter")[0].context.events.add("click",t);$("#btn_nextpage")[0]&&$("#btn_nextpage")[0].context.events.add("click",n);h=setInterval(c,24e4)};window.addEventListener("load",l,!1)})();