"use strict";(function(){var e=function(n){return n.replace(/(^\s*)|(\s*$)/g,"")},h=/[^A-Za-z0-9_@.]+/,c=1e3,f=100,t=!0,n=!1,l=function(i){var r=$.Deferred();if(t===!1)r.resolve({succ:n,err:null});else if(i.length<=0)t=!1,n=!1,r.resolve({succ:n,err:"用户名不能为空"});else if(i.match(h))t=!1,n=!1,r.resolve({succ:n,err:"用户名格式错误"});else{var f={name:i},e=new Date,u=function(i){t=!1;n=i?!0:!1;r.resolve({succ:n,err:null})};$.ajax({url:"/member/queryloginname",type:"POST",data:JSON.stringify(f),contentType:"application/json; charset=utf-8",dataType:"json"}).done(function(n){var i=new Date,t=i-e;t<1e3?setTimeout(u,1e3-t,n):u(n)}).fail(function(i){t=!0;n=!1;r.resolve({succ:!1,err:i})})}return r.promise()},o=function(n){if(n.type!=="blur"||t!==!1){var i=n.currentTarget.parentElement,r=e(i.context.get_value());i.context.set_hint("always",null,"正在检测用户名");i.context.clear_error();t=!0;l(r).done(function(n){n.err!==null?(i.context.clear_hint(),i.context.set_error(n.err)):n.succ?(i.context.clear_hint(),i.context.clear_error()):(i.context.clear_hint(),i.context.set_error("该用户名已被使用"))})}},s=function(n){var t=n.currentTarget.parentElement,i=e(t.context.get_value());i.length<=0?t.context.set_error("输入不能为空"):t.context.clear_error()},u=function(){var n=i.context.get_value(),t=r.context.get_value();n===t?n.length<=0?(i.context.set_error("密码不能为空"),r.context.set_error("密码不能为空")):(i.context.clear_error(),r.context.clear_error()):(i.context.set_error("密码不一致"),r.context.set_error("密码不一致"))},a=function(){var n=$("#hidden_submiter");n.find("[name='ticket']")[0].value=$("#input_ticket")[0].context.get_value();n.find("[name='loginname']")[0].value=$("#input_loginname")[0].context.get_value();n.find("[name='password']")[0].value=$.md5($("#input_pwd")[0].context.get_value());n.find("[name='name']")[0].value=$("#input_name")[0].context.get_value();n.find("[name='grade']")[0].value=$("#input_grade")[0].context.get_value();n.find("[name='sexual']")[0].value=$("#input_sexual")[0].context.selected_item().innerText;n.find("[name='school']")[0].value=$("#input_school")[0].context.selected_item().innerText},v=function(n){n.context.set_enabled(!1);$("#load_ring")[0].style.opacity=1;$.debounce(1e3,function(){a();$("#hidden_submiter")[0].submit()})()},i,r,y=function(){var n=$($("#input_loginname")[0].context.input);n.blur(o);n.keyup($.debounce(c,o));i=$("#input_pwd")[0];r=$("#input_pwd_confirm")[0];$(i.context.input).keyup($.debounce(f,u));$(i.context.input).blur(u);$(r.context.input).keyup($.debounce(f,u));$(r.context.input).blur(u);$($("#input_name")[0].context.input).blur(s);$($("#input_name")[0].context.input).keyup($.debounce(f,s));$("#btn_submit")[0].context.events.add("click",v);$("#userpic").change(function(){var t=$("#userpic")[0].files,i=window.URL||window.webkitURL,n;t.length<=0?(n="",$("#preview_img")[0].src=n):(n=i.createObjectURL(this.files[0]),$("#preview_img")[0].src=n)});$("#btn_pickpic")[0].context.events.add("click",function(){$("#userpic").click()})};window.addEventListener("load",y,!1)})();