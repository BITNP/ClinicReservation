"use strict";(function(){var o=function(){var t="",r=$("#input_name")[0].context.get_value(),u=$("#input_phonenumber")[0].context.get_value(),f=$("#input_email")[0].context.get_value(),e=$("#input_qqnumber")[0].context.get_value(),o=$("#input_posterschool")[0].context.selected_index(),i,n;t=escape(r)+"|xx|"+escape(u)+"|xx|"+escape(f)+"|xx|"+escape(e)+"|xx|"+o;i=30;n=new Date;n.setTime(n.getTime()+i*864e5);document.cookie="pdata="+t+";expires="+n.toGMTString()},s=function(){var n=new Date;n.setTime(n.getTime()-1);document.cookie="pdata=val;expires="+n.toGMTString()},h=function(){var i,r=new RegExp("(^| )pdata=([^;]*)(;|$)"),t=$("#checkbox_savepdata"),n;(i=document.cookie.match(r))?(n=i[2].split("|xx|"),t.length>0&&$("#checkbox_savepdata")[0].context.set_checked(!0),$("#input_name")[0].context.set_value(unescape(n[0])),$("#input_phonenumber")[0].context.set_value(unescape(n[1])),$("#input_email")[0].context.set_value(unescape(n[2])),$("#input_qqnumber")[0].context.set_value(unescape(n[3])),$("#input_posterschool")[0].context.set_selected(parseInt(n[4],10))):t.length>0&&t[0].context.set_checked(!1)},f=function(){var i=$("#input_detail")[0].context.get_value(),n=!0;(i===undefined||i.length<=5)&&(n=!1);t(1)===!1&&(n=!1);r(1)===!1&&(n=!1);n?$("#btn_submit")[0].context.set_enabled(!0):$("#btn_submit")[0].context.set_enabled(!1)},c=function(){var n=$("#hidden_submiter"),t,i;n.find("[name='postername']")[0].value=$("#input_name")[0].context.get_value();n.find("[name='posterphone']")[0].value=$("#input_phonenumber")[0].context.get_value();n.find("[name='posteremail']")[0].value=$("#input_email")[0].context.get_value();n.find("[name='posterqq']")[0].value=$("#input_qqnumber")[0].context.get_value();n.find("[name='posterschool']")[0].value=$("#input_posterschool")[0].context.selected_item().innerText;n.find("[name='problemtype']")[0].value=$("#input_questiontype")[0].context.selected_item().innerText;n.find("[name='problemdetail']")[0].value=$("#input_detail")[0].context.get_value();n.find("[name='location']")[0].value=$("#input_location")[0].context.selected_item().innerText;t=$("#input_bookdate")[0].context.get_date();i=t.year+"/"+t.month+"/"+t.day;n.find("[name='bookdate']")[0].value=i},i=1500,l=function(){$("#input_name_hint").addClass("show")},a=function(){$("#input_name_hint").removeClass("show")},v=function(){$("#input_phone_hint").addClass("show")},y=function(){$("#input_phone_hint").removeClass("show");r()},r=function(){var n=$("#input_phonenumber")[0].context.get_value();return n===null||n===undefined||n.length===0?($("#input_phonenumber")[0].removeAttribute("data-error"),$("#input_phone_err").removeClass("show"),!0):/^\d+$/gi.test(n)?($("#input_phonenumber")[0].removeAttribute("data-error"),$("#input_phone_err").removeClass("show"),!0):($("#input_phonenumber")[0].setAttribute("data-error",!0),$("#input_phone_err").addClass("show"),!1)},p=function(){$("#input_mail_hint").addClass("show");$("#input_email")[0].removeAttribute("data-error");$("#input_mail_err").removeClass("show");$.debounce(i,t)()},w=function(){$("#input_mail_hint").removeClass("show");t()},t=function(){var n=$("#input_email")[0].context.get_value();return n===null||n===undefined||n.length===0?($("#input_email")[0].removeAttribute("data-error"),$("#input_mail_err").removeClass("show"),!0):/^([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\-|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/gi.test(n)?($("#input_email")[0].removeAttribute("data-error"),$("#input_mail_err").removeClass("show"),!0):($("#input_email")[0].setAttribute("data-error",!0),$("#input_mail_err").addClass("show"),!1)},b=function(){$("#input_qq_hint").addClass("show")},k=function(){$("#input_qq_hint").removeClass("show")},n=-1,u=function(t){var i=t.currentTarget,u=null,r;if(u=i===null?t.parentElement:i.parentElement,n>=0&&$(u.children[n]).removeClass("selected"),n=-1,i!==null){for($(i).addClass("selected"),r=0;r<u.children.length;r++)u.children[r]===i&&(n=r);if(t.change===undefined){var f=new Date,e=f.getTime()+n*864e5,o=new Date(e);$("#input_bookdate")[0].context.set_date(o)}}},d=function(n,t){var i=t.date.year+"/"+t.date.month+"/"+t.date.day,r=new Date(i);g(r)},g=function(n){var r=new Date,t=parseInt(Math.ceil((n-r)/864e5)),i=$(".date-quick-pick > p")[0].parentElement;t<0?u({currentTarget:null,parentElement:i,change:!1}):t<i.children.length?u({currentTarget:$(".date-quick-pick > p")[0].parentElement.children[t],change:!1}):u({currentTarget:null,parentElement:i,change:!1})},nt=function(n){n.context.set_enabled(!1);$("#load_ring")[0].style.opacity=1;var t=!1;$("#checkbox_savepdata")[0]&&(t=$("#checkbox_savepdata")[0].context.is_checked());t?o():s();$.debounce(1e3,function(){c();$("#hidden_submiter")[0].submit()})()},e,tt=function(){e=window.siteLanguageSpecifier?window.siteLanguageSpecifier:"";$("#hidden_submiter").attr("action",e+$("#hidden_submiter").attr("action"));h();$(".date-quick-pick > p").click(u);$("#input_bookdate")[0].context.events.add("changed",d);n=0;$($("#input_name")[0].context.input).focus(l);$($("#input_name")[0].context.input).blur(a);$($("#input_qqnumber")[0].context.input).focus(b);$($("#input_qqnumber")[0].context.input).blur(k);$($("#input_email")[0].context.input).focus(p);$($("#input_email")[0].context.input).blur(w);$($("#input_email")[0].context.input).keyup($.debounce(i,t));$($("#input_email")[0].context.input).keydown(function(){$("#input_email")[0].removeAttribute("data-error");$("#input_mail_err").removeClass("show")});$($("#input_email")[0].context.input).change(t);$($("#input_phonenumber")[0].context.input).focus(v);$($("#input_phonenumber")[0].context.input).blur(y);$($("#input_phonenumber")[0].context.input).keyup($.debounce(i,r));$($("#input_phonenumber")[0].context.input).keydown(function(){$("#input_phonenumber")[0].removeAttribute("data-error");$("#input_phone_err").removeClass("show")});$($("#input_phonenumber")[0].context.input).change(r);$($("#input_detail")[0].context.input).change(f);$($("#input_detail")[0].context.input).keyup($.debounce(i,f));f();$("#btn_submit")[0].context.events.add("click",nt)};window.addEventListener("load",tt,!1)})();